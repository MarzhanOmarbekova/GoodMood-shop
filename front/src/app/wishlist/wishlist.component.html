<div class="wishlist-container">
  <h2>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h2>

  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>–ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞—à —Å–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ...</p>
  </div>

  <div *ngIf="!loading && products.length === 0" class="empty-state">
    <div class="empty-icon">‚ù§Ô∏è</div>
    <h3>–í–∞—à —Å–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—É—Å—Ç</h3>
    <p>–î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è —Ç–æ–≤–∞—Ä—ã –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –∏—Ö</p>
    <button class="browse-btn" (click)="navigateToHome()">
      –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º
    </button>
  </div>

  <div *ngIf="!loading && products.length > 0" class="products-grid">
    <div *ngFor="let product of products" class="product-card">
      <div class="product-image">
        <img [src]="product.main_image_url" [alt]="product.name" (click)="navigateToProduct(product.product_id)">
        <div class="product-actions">
          <button class="action-btn remove-btn" (click)="removeFromWishlist(product.product_id)">
            <span class="icon">√ó</span>
            Delete
          </button>
          <button class="action-btn add-cart-btn" (click)="openModal(product.product_id)">
            <span class="icon">üõí</span>
            Add to Cart
          </button>
        </div>
      </div>
      <div class="product-info">
        <h3 (click)="navigateToProduct(product.product_id)">{{ product.name }}</h3>
        <p class="price">{{ product.price | number:'1.0-0' }} ‚ÇΩ</p>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div *ngIf="selectedProductDetail" class="modal-overlay" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="modal-close" (click)="closeModal()">√ó</button>
    
    <div class="modal-header">
      <h3>{{ selectedProductDetail.name }}</h3>
      <p class="modal-price">{{ selectedProductDetail.price }} ‚ÇΩ</p>
    </div>

    <div class="modal-body">
      <div class="form-group">
        <label for="variantSelect">Size:</label>
        <select id="variantSelect" [(ngModel)]="selectedVariantId" class="form-control" [class.error]="showSizeError">
          <option value="" disabled selected>Select size</option>
          <option *ngFor="let v of selectedProductDetail.variants" [value]="v.product_variant_id">
            {{ v.size }} ‚Äî {{ v.price }} ‚ÇΩ
          </option>
        </select>
        <small class="error-message" *ngIf="showSizeError">Please select a size</small>
      </div>

      <div class="form-group">
        <label for="quantity">Quantity:</label>
        <div class="quantity-control">
          <button class="quantity-btn" (click)="selectedQuantity = selectedQuantity > 1 ? selectedQuantity - 1 : 1" [disabled]="isAddingToCart">-</button>
          <input type="number" id="quantity" [(ngModel)]="selectedQuantity" min="1" class="form-control" [disabled]="isAddingToCart">
          <button class="quantity-btn" (click)="selectedQuantity = selectedQuantity + 1" [disabled]="isAddingToCart">+</button>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="modal-btn cancel-btn" (click)="closeModal()" [disabled]="isAddingToCart">Cancel</button>
      <button class="modal-btn confirm-btn" (click)="addToCart()" [disabled]="!selectedVariantId || isAddingToCart">
        <span *ngIf="!isAddingToCart">Add to Cart</span>
        <span *ngIf="isAddingToCart">Adding...</span>
      </button>
    </div>

    <div class="error-notification" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>
  </div>
</div>

