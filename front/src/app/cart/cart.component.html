<div class="cart-container">
  <h2>–ú–æ—è –∫–æ—Ä–∑–∏–Ω–∞</h2>

  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã...</p>
  </div>

  <div *ngIf="!loading && cartItems.length === 0" class="empty-state">
    <div class="empty-icon">üõí</div>
    <h3>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h3>
    <p>–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É, —á—Ç–æ–±—ã –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</p>
    <button routerLink="/" class="browse-btn">–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º</button>
  </div>

  <div class="cart-content" *ngIf="!loading && cartItems.length > 0">
    <div class="cart-items">
      <div class="cart-item" *ngFor="let item of cartItems" [class.updating]="isUpdating(item.product_variant_id)">
        <div class="item-image-container">
          <img [src]="item.product_main_image" [alt]="item.product_name" class="item-image" />
        </div>

        <div class="item-details">
          <div class="item-header">
            <h3>{{ item.product_name }}</h3>
            <button class="remove-btn" (click)="removeItem(item.product_variant_id)" [disabled]="isUpdating(item.product_variant_id)">
              <span class="remove-icon">√ó</span>
            </button>
          </div>

          <p class="description">{{ item.product_description }}</p>
          
          <div class="item-meta">
            <span class="size">–†–∞–∑–º–µ—Ä: {{ item.size }}</span>
            <span class="color">–¶–≤–µ—Ç: {{ item.color }}</span>
          </div>

          <div class="item-controls">
            <div class="quantity-control">
              <button 
                (click)="updateQuantity(item, item.quantity - 1)"
                [disabled]="item.quantity <= 1 || isUpdating(item.product_variant_id)"
                class="quantity-btn">
                ‚àí
              </button> 
              <input 
                type="number" 
                [ngModel]="item.quantity"
                (ngModelChange)="updateQuantity(item, $event)"
                [min]="1"
                [max]="item.stock"
                [disabled]="isUpdating(item.product_variant_id)"
                class="quantity-input">
              <button 
                (click)="updateQuantity(item, item.quantity + 1)"
                [disabled]="item.quantity >= item.stock || isUpdating(item.product_variant_id)"
                class="quantity-btn">
                +
              </button>
            </div>

            <div class="price-info">
              <p class="unit-price">{{ item.price }} ‚Ç∏ –∑–∞ —à—Ç.</p>
              <p class="total-price">{{ item.item_total_price }} ‚Ç∏</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="cart-summary">
      <h3>–ò—Ç–æ–≥–æ –∑–∞–∫–∞–∑–∞</h3>
      <div class="summary-row">
        <span>–¢–æ–≤–∞—Ä—ã ({{cartItems.length}})</span>
        <span>{{ totalPrice }} ‚Ç∏</span>
      </div>
      <div class="summary-row">
        <span>–î–æ—Å—Ç–∞–≤–∫–∞</span>
        <span>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
      </div>
      <div class="summary-total">
        <span>–ö –æ–ø–ª–∞—Ç–µ</span>
        <span>{{ totalPrice }} ‚Ç∏</span>
      </div>
      <button class="checkout-btn" (click)="checkout()">
        –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
      </button>
    </div>
  </div>
</div>
